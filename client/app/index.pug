extends navbar
include template/_mixins

block navbar
	ul.nav.navbar-nav
		li(ng-class="{ active: menu == 'home' }")
			a(ui-sref="home") Home
		li(ng-class="{ active: menu == 'games' }")
			a(ui-sref="games") Games
		li(ng-class="{ active: menu == 'releases' }")
			a(ui-sref="releases") Releases
		li.uib-dropdown(ng-class="{ active: menu == 'admin' }", ng-show="auth.hasRole(['root', 'admin', 'moderator'])", on-toggle="toggled(open)", uib-dropdown)
			a.space-right.uib-dropdown-toggle(uib-dropdown-toggle)
				span.space-right-2x Admin
				+icon('angle-down').smaller.shift-up
			ul.uib-dropdown-menu(role="menu")
				li(ng-show="auth.hasPermission('*/moderate')")
					a(ui-sref="adminUploads")
						+icon('upload').space-right.shift-up
						span Uploads
				li
					a(ui-sref="adminUsers")
						+icon('users').space-right.shift-up
						span Users

	ul.nav.navbar-nav.navbar-right
		li.uib-dropdown(ng-show="(auth.hasPermission('releases/add') || auth.hasPermission('games/add') || auth.hasPermission('backglasses/add')) && themeName === 'theme-dark'", on-toggle="toggled(open)", uib-dropdown)
			a.btn.btn-hollow.space-right.uib-dropdown-toggle(uib-dropdown-toggle) Upload
			ul.uib-dropdown-menu
				li(ng-show="auth.hasPermission('games/add')")
					a(ui-sref="addGame")
						span Game Data
				li(ng-show="auth.hasPermission('releases/add')")
					a(ng-click="uploadRelease()")
						span Recreation
				//li
					a
						span Original Game
				li(ng-show="auth.hasPermission('backglasses/add')")
					a(ng-click="uploadBackglass()")
						span Direct B2S


		li(ng-hide="auth.isAuthenticated")
			a(ng-click="login()")
				+icon('lock').small.space-right.shift-up
				span.space-right Login
		li.uib-dropdown(ng-show="auth.isAuthenticated", on-toggle="toggled(open)", uib-dropdown)
			a.space-right.uib-dropdown-toggle(uib-dropdown-toggle)
				span.space-right-2x {{ auth.user.name }}
				+icon('angle-down').smaller.shift-up
			ul.uib-dropdown-menu
				li
					a(ui-sref="profile.settings")
						+icon('user').space-right.shift-up
						span Profile
				li
					a(ng-click="auth.logout()")
						+icon('exit').space-right.shift-up
						span Logout

block content

	div(ng-repeat="(id, notification) in notifications track by id")
		growl-notification(ttl="notification.ttl").ns-effect-slide.ns-type-notice
			+icon('times').a.ns-close(ng-click="$growlNotification.remove()")
			span(ng-bind-html="notification.message")
	.container.container--topmost(ng-cloak)

		section#timeoutNotice.uib-collapse(uib-collapse="timeoutNoticeCollapsed")
			label
				+icon('info').small.shift-up.space-right
				| You have been inactive for too long and need to login again.
			.pull-right
				a(ng-click="timeoutNoticeCollapsed = true")
					+icon('times').small.shift-up.space-right

		| <div ui-view></div>

		footer
			.text-center
				a.space-right.space-left(ui-sref="about", ng-class="{ active: menu == 'about' }") About
				a.space-right.space-left-2x(ui-sref="rules", ng-class="{ active: menu == 'rules' }") Rules
				a.space-right.space-left-2x(ui-sref="faq", ng-class="{ active: menu == 'faq' }") FAQ
				a.space-right.space-left-2x(href="https://developer.vpdb.io/") Contribute
				a.space-right.space-left-2x(ui-sref="legal", ng-class="{ active: menu == 'legal' }") Legal
				a.space-left-2x(ui-sref="privacy", ng-class="{ active: menu == 'privacy' }") Privacy Policy

	.spinner-overlay.fade-animation(ng-show="loading", ng-cloak)
		.spinner

	script(type="text/ng-template", id="user-item.html")
		small.user-mention-info(ng-show="typedTerm.length < 3")
			+icon('info').shift-up.space-right-less
			| Type 3 characters in order to search for a user
		ul.list-group.list-group--users
			li.list-group-item(mentio-menu-item="person", ng-repeat="person in items | filter: '!!'")
				img.img-avatar.img-avatar--xsm.pull-left.space-right(gravatar-src="person.gravatar_id", gravatar-default="404", fallback-icon="user")
				div.pull-left(ng-bind-html="person.name | mentioHighlight:typedTerm:'menu-highlighted' | unsafe")
				.clearfix

