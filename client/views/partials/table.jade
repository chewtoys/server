.row.ng-cloak.row-fullheight(ng-controller="TableController")
	.col-sm-10.col-main
		h1 {{ table.name }}
		h3.pull-right {{table.manufacturer}} &middot; {{table.year}}
		hr
		h2 Releases
		div(ng-repeat="release in table.releases")
			.panel.panel-dark.panel-dark-detailed
				.sidebar-wrapper
					a.image-link(href="{{release.thumbs.playfield}}")
						.img-wrapper
							.img(style="background-image:url('{{release.thumbs.playfield}}')")
					.ratingbox(rating-avg="release.rating", rating-votes="release.votes", ng-mouseenter="editing=true", ng-mouseleave="editing=false")
						.ratingbox-left
							.ratingbox-rating.rating-user(ng-show="editing") {{hoverRating | rating}}
							.ratingbox-rating(ng-class="{ 'rating-hide' : editing }") {{release.rating | rating}}
						.ratingbox-right
							rating.rating-user(ng-show="editing", value="ratingUser", max="10", rating-states="states", on-hover="hoverRating = value", on-leave="hoverRating = ratingUser")
							rating.rating-avg(ng-hide="editing", value="ratingAvg", max="10", rating-states="states", readonly="true")
							span.votes {{release.votes}} vote{{release.votes == 1 ? '' : 's'}}
				.data-wrapper
					h1 {{release.title}}
					label
						i.icon.icon-user
						span {{release.submitter.user}}
					label
						i.fa.fa-arrow-circle-up
						time-ago(from-time="{{release.lastversion.timestamp}}")
					label
						i.fa.fa-arrow-circle-down
						span {{release.lastversion.downloads}} downloads

					accordion.accordion-glued(close-others="true")
						accordion-group(heading="Description", is-open="true")
							div.markdown(markdown="release.description")

						accordion-group(heading="Authors")
							div.thumbnail.thumbnail-avatar.pull-left(ng-repeat="author in release.authors")
								div.media-avatar-medium(ng-hide="author.author.avatar")
								img.media-avatar-medium(ng-show="author.author.avatar", ng-src="{{author.author.avatar}}")
								.caption
									h1 {{author.author.user}}
									label {{author.roles.join(', ')}}

						accordion-group(heading="Acknowledgements")
							div.markdown(markdown="release.acknowledgements")

						accordion-group(heading="Gallery")
							p here is the gallery
				.padder-notop
					button.btn.btn-primary.btn-lg.btn-download.pull-right
						i.fa.fa-download
						| &nbsp;&nbsp;Download
					.btn-group
						button.btn.btn-default.btn-lg.btn-media(type="button")
							i.fa.fa-download
							| &nbsp;&nbsp;Media
						button.btn.btn-default.btn-lg.dropdown-toggle(type="button", data-toggle="dropdown")
							i.fa.fa-angle-down
							span.sr-only Toggle Dropdown
						ul.dropdown-menu(role="menu")
							li
								a(href="#") Action
							li
								a(href="#") Another action
							li
								a(href="#") Something else here
							li.divider
							li
								a(href="#") Separated link
				.clearfix

			.panel.panel-dark(ng-controller="CommentsCtrl")
				h3 Comments on Release
				.media(ng-repeat="comment in release.comments" ng-controller="CommentCtrl")
					div.media-object.media-avatar-medium.pull-left(ng-hide="comment.author.avatar")
					img.media-object.media-avatar-medium.pull-left(ng-show="comment.author.avatar", ng-src="{{comment.author.avatar}}")
					.media-body
						.panel.panel-light
							.panel-triangle
							.panel-header
								label
								strong {{ comment.author.user }}
								| &nbsp;commented
								time-ago(from-time="{{comment.timestamp}}")
								.pull-right
									i.fa.fa-pencil(ng-click="editComment()")
									i.fa.fa-times-circle(ng-click="deleteComment()")

							.panel-content
								div.markdown(ng-hide="editing", markdown="comment.message")
								textarea.msd-elastic(ng-show="editing", placeholder="Update comment", ng-model="updatedComment")
							.panel-footer(ng-show="editing")
								button.btn.btn-default.pull-left(ng-click="cancelEdit()") Cancel
								button.btn.btn-default.pull-right(ng-click="saveComment()") Update Comment
								.clearfix

				.media
					div.media-avatar-medium.pull-left
					.media-body
						tabset.tabset-newcomment
							label.label-small.pull-right Comments are parsed with <a href="http://daringfireball.net/projects/markdown/syntax" target="_blank">Markdown</a>.
							tab
								tab-heading
									i.fa.fa-edit(title="Write")
									.panel-triangle
								textarea.msd-elastic(placeholder="Leave a comment", ng-model="$parent.newComment")
							tab
								tab-heading
									i.fa.fa-eye(title="Preview")
								div.markdown(markdown="$parent.newComment")
								label.label-message(ng-show="!newComment || newComment.length == 0") Nothing to preview.

				button.btn.btn-default.btn-comment.pull-right(ng-click="addComment()") Comment
				.clearfix

		h2 ROMs
		table.table.table-striped
			thead
				tr
					th Name
					th Version
					th Language
					th Notes
					th DLs
					th Size
					th
			tbody
				tr(ng-repeat="rom in table.roms")
					td
						samp {{ rom.name }}
					td {{ rom.version }}
					td {{ rom.language }}
					td {{ rom.notes }}
					td {{ rom.downloads }}
					td {{ rom.size }}
					td.nostripe.td-dlbtn
						button.btn.btn-primary.btn-xs
							i.fa.fa-download

		h2 Direct B2S Backglasses
		h2 Media
		h2 Alternative Media

		p
			br
	.col-sm-2.col-menu
		img.img-logo(ng-src="{{table.thumbs.logo}}")

		.ratingbox(rating-avg="table.ipdb.rating")
			.ratingbox-left
				.ratingbox-rating {{table.ipdb.rating | rating}}
			.ratingbox-right
				rating.rating-avg(value="ratingAvg", max="10", rating-states="states", readonly="true")
				span.votes {{table.ipdb.votes}} vote{{table.ipdb.votes == 1 ? '' : 's'}}
		hr
		.ratingbox(rating-avg="$parent.table.rating", rating-votes="$parent.table.votes", ng-mouseenter="editing=true", ng-mouseleave="editing=false")
			.ratingbox-left
				.ratingbox-rating.rating-user(ng-show="editing") {{hoverRating | rating}}
				.ratingbox-rating(ng-class="{ 'rating-hide' : editing }") {{$parent.table.rating | rating}}
			.ratingbox-right
				rating.rating-user(ng-show="editing", value="ratingUser", max="10", rating-states="states", on-hover="hoverRating = value", on-leave="hoverRating = ratingUser")
				rating.rating-avg(ng-hide="editing", value="ratingAvg", max="10", rating-states="states", readonly="true")
				span.votes {{$parent.table.votes}} vote{{$parent.table.votes == 1 ? '' : 's'}}

